import { useThemeContext } from 'aave-ui-kit';
import { useEffect, useState } from 'react';

interface HealthSpeedChartProps {
  value: number;
}

export default function HealthSpeedChart({ value }: HealthSpeedChartProps) {
  const [angle, setAngle] = useState(0);
  const { currentTheme } = useThemeContext();

  useEffect(() => {
    if (value <= 1.3) {
      // 0.0 - 1.3 for red section
      setAngle((value / 1.3) * 33);
    } else if (value <= 2.1) {
      // 1.3 - 2.1 for yellow section
      setAngle((value / 2.1) * 60);
    } else if (value <= 4.1) {
      // 2.1 - 4.1 for green section with liner
      setAngle((value / 4.1) * 120);
    } else if (value <= 100) {
      // 4.1 - 100 for green section with log
      setAngle(120 + (Math.log10(value) / 2) * 50);
    } else {
      // 100 - infinite (10**6): last
      setAngle(170 + (Math.log10(value) / 6) * 10);
    }
  }, []);

  return (
    <div className="HealthSpeedChart">
      <svg
        width="416"
        height="191"
        viewBox="0 0 416 191"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M6.38 180.52C5.27333 180.52 4.3 180.22 3.46 179.62C2.62 179.006 1.96667 178.146 1.5 177.04C1.04667 175.933 0.82 174.646 0.82 173.18C0.82 171.74 1.04667 170.473 1.5 169.38C1.95333 168.273 2.6 167.42 3.44 166.82C4.28 166.22 5.26 165.92 6.38 165.92C7.47333 165.92 8.44 166.22 9.28 166.82C10.12 167.406 10.7667 168.253 11.22 169.36C11.6867 170.453 11.92 171.726 11.92 173.18C11.92 174.633 11.6933 175.913 11.24 177.02C10.7867 178.126 10.14 178.986 9.3 179.6C8.46 180.213 7.48667 180.52 6.38 180.52ZM6.38 178.3C7.00667 178.3 7.55333 178.093 8.02 177.68C8.5 177.253 8.86667 176.653 9.12 175.88C9.37333 175.106 9.5 174.206 9.5 173.18C9.5 172.166 9.37333 171.28 9.12 170.52C8.86667 169.746 8.5 169.153 8.02 168.74C7.55333 168.326 7.00667 168.12 6.38 168.12C5.42 168.12 4.65333 168.58 4.08 169.5C3.52 170.406 3.24 171.633 3.24 173.18C3.24 174.74 3.52 175.986 4.08 176.92C4.65333 177.84 5.42 178.3 6.38 178.3Z"
          fill={currentTheme.text.main}
        />
        <path
          d="M415.625 174.22C415.624 175.332 415.294 176.418 414.675 177.342C414.057 178.266 413.179 178.987 412.152 179.412C411.125 179.837 409.994 179.949 408.904 179.732C407.813 179.515 406.812 178.98 406.025 178.195L405.978 178.148L400.362 171.81C399.888 171.345 399.286 171.03 398.634 170.905C397.981 170.78 397.305 170.851 396.693 171.108C396.08 171.365 395.556 171.798 395.188 172.352C394.82 172.905 394.624 173.555 394.624 174.22C394.624 174.885 394.82 175.534 395.188 176.088C395.556 176.642 396.08 177.074 396.693 177.332C397.305 177.589 397.981 177.66 398.634 177.535C399.286 177.41 399.888 177.095 400.362 176.629L400.653 176.301C400.851 176.077 401.129 175.941 401.427 175.923C401.725 175.904 402.018 176.005 402.242 176.203C402.466 176.4 402.602 176.679 402.621 176.977C402.639 177.275 402.538 177.568 402.341 177.792L402.022 178.148L401.975 178.195C401.453 178.717 400.834 179.132 400.152 179.415C399.47 179.698 398.738 179.844 398 179.844C397.262 179.844 396.53 179.698 395.848 179.415C395.166 179.132 394.547 178.717 394.025 178.195C393.239 177.408 392.704 176.406 392.488 175.316C392.271 174.225 392.383 173.095 392.808 172.068C393.233 171.041 393.953 170.162 394.878 169.544C395.802 168.926 396.888 168.596 398 168.595C398.739 168.592 399.471 168.736 400.154 169.02C400.836 169.303 401.455 169.719 401.975 170.245L402.022 170.292L407.637 176.629C408.112 177.095 408.713 177.41 409.366 177.535C410.019 177.66 410.695 177.589 411.307 177.332C411.92 177.074 412.444 176.642 412.812 176.088C413.18 175.534 413.376 174.885 413.376 174.22C413.376 173.555 413.18 172.905 412.812 172.352C412.444 171.798 411.92 171.365 411.307 171.108C410.695 170.851 410.019 170.78 409.366 170.905C408.713 171.03 408.112 171.345 407.637 171.81L407.347 172.139C407.149 172.362 406.871 172.498 406.573 172.517C406.275 172.535 405.982 172.435 405.758 172.237C405.534 172.039 405.398 171.761 405.379 171.463C405.361 171.165 405.462 170.872 405.659 170.648L405.978 170.292L406.025 170.245C406.812 169.459 407.813 168.924 408.904 168.708C409.994 168.491 411.125 168.602 412.152 169.028C413.179 169.453 414.057 170.173 414.675 171.097C415.294 172.021 415.624 173.108 415.625 174.22Z"
          fill={currentTheme.text.main}
        />
        <path
          id="cursorSpeed"
          d="M204.968 177.506C205.079 181.524 201.805 184.818 197.786 184.733L54.204 181.669L197.398 170.686C201.406 170.378 204.857 173.487 204.968 177.506Z"
          fill={currentTheme.text.main}
        />
        <path
          d="M40.42 110.04C31.494 131.659 26.9332 154.83 27 178.22C26.9873 180.405 27.6255 182.544 28.8333 184.365C30.0411 186.185 31.7638 187.605 33.7817 188.443C35.7996 189.281 38.0213 189.499 40.1635 189.069C42.3057 188.639 44.2714 187.581 45.81 186.03C47.8588 183.947 49.0049 181.141 49 178.22C48.961 147.955 57.7726 118.34 74.35 93.0198L56.53 79.7698C50.1926 89.3144 44.7972 99.452 40.42 110.04Z"
          fill="#FF3B30"
        />
        <path
          d="M368.58 110.04C359.432 87.8815 345.893 67.8045 328.779 51.0182C311.665 34.232 291.329 21.084 268.998 12.3664C246.667 3.6489 222.802 -0.457779 198.842 0.293829C174.881 1.04544 151.321 6.63977 129.58 16.7398C126.4 18.2331 123.263 19.8198 120.17 21.4998L130.17 41.3298C133.05 39.7598 135.97 38.2598 138.95 36.8598C162.672 25.8263 188.795 20.9573 214.899 22.7037C241.003 24.45 266.244 32.7554 288.285 46.8504C310.326 60.9455 328.454 80.3745 340.99 103.338C353.526 126.302 360.064 152.057 360 178.22C360 181.137 361.159 183.935 363.222 185.998C365.285 188.061 368.083 189.22 371 189.22C373.917 189.22 376.715 188.061 378.778 185.998C380.841 183.935 382 181.137 382 178.22C382.067 154.83 377.506 131.659 368.58 110.04Z"
          fill="#28CD41"
        />
        <path
          d="M79 52.3398C70.6057 60.7034 63.0775 69.8933 56.53 79.7698L74.38 92.9798C88.4582 71.4473 107.618 53.7093 130.17 41.3298L120.17 21.4998C105.02 29.7235 91.151 40.1129 79 52.3398Z"
          fill="#FF9500"
        />
      </svg>

      <style jsx={true} global={true}>
        {`
          @import 'src/_mixins/variables';
          @import 'src/_mixins/screen-size';

          .HealthSpeedChart {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 416px;
            height: 191px;
            border-radius: 50%;
            position: relative;

            #cursorSpeed {
              animation: spin 3s;
              transform-origin: 204px 180px;
              transform: rotate(${angle}deg);
            }
            @keyframes spin {
              0% {
                transform: rotate(0deg);
              }
              100% {
                transform: rotate(${angle}deg);
              }
            }
          }
        `}
      </style>
    </div>
  );
}
